<!-- sub-template for index page -->
<div>
	<h2>GPS Analysis</h2>
	<my-index-gps-data>
	<p>Index 2</p>
	</my-index-gps-data>
</div>

<!-- content block -->
<div class="container-fluid">
	<div class="jumbotron">
		<p>Learn to Create Websites</p>
	</div>
	<div class="row">
		<div class="col-xs-4 col-sm-4 col-md-4 col-lg-4 ">
			<p>HTML</p>
		</div>
		<div class="col-xs-4 col-sm-4 col-md-4 col-lg-4">
			<p>Upload</p>

			<section>

				<input type="file" id="images_for_upload" name="images_for_upload"
					multiple="true" value="Add Images" accept="image/*"
					required="required"> <input type="button" id="btn_upload"
					value="Upload Images">
			</section>
			<section>
				<strong>Files You Selected:</strong>
				<ul id="files_list">
					<li>No Files Selected</li>
				</ul>
			</section>
			<section>
				<table id="photo_table">
				<tr><td id="addbirdphoto">Upload photos</td></tr>
			</table>
			</section>
		</div>
		<div class="col-xs-4 col-sm-4 col-md-4 col-lg-4">
			<p>Bootstrap</p>
		</div>
	</div>
</div>

<!-- js libs -->
<script type="text/javascript" src="/js/plugin_mis/numeric-1.2.6.min.js"></script>
<script type="text/javascript"
	src="/js/plugin_mis/particle_swarm_optimization.js"></script>
<script type="text/javascript">
<!--
	var imgs_for_upload = [];
	$('#images_for_upload')
			.change(
					function() {

						var input = document
								.getElementById("images_for_upload");
						var ul = document.getElementById("files_list");
						var toolarge = "";
						var maxsize = 1024000;
						while (ul.hasChildNodes()) {
							ul.removeChild(ul.firstChild);
						}
						for ( var i = 0; i < input.files.length; i++) {

							if (input.files[i].size > maxsize) {
								toolarge += input.files[i].name + "\n";
							} else {
								var li = document.createElement("li");
								li.innerHTML = input.files[i].name;
								ul.appendChild(li);
								imgs_for_upload.push(input.files[i]);
							}

						}
						if (!ul.hasChildNodes()) {
							var li = document.createElement("li");
							li.innerHTML = 'No Files Selected';
							ul.appendChild(li);
						}

						//
						if (toolarge != "") {
							alert("These images were not uploaded due to size limit of 1MB\n"
									+ toolarge);
						}
					});

	$('#btn_upload').click(function() {
		var data=new FormData();
		data.append("images_for_upload",imgs_for_upload);
		
		//
		send_imgs(data);
	});
	
	function send_imgs(filedata) {
		alert('upload imgs');
		$.ajax({
	    	url: '/base/upload_img',
	    	data: filedata,
	    	cache: false,
	    	contentType: false,
	   	    processData: false,
	    	type: 'POST',
	    	success: function(receiveddata){
	    		var data=JSON.parse(receiveddata);
	    		imagelinks=data['img_urls'];
	    		for(var i=0;i<imagelinks.length;i++){
	        	$('#photo_table').append('<tr><td><img src='+imagelinks[i]+'/></td></tr>');
	        }
	        }    	
			});

		}
//-->
</script>